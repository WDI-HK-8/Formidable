app.controller('SignUpCtrl', ['$scope','$auth','$location','$window','$http', function($scope,$auth,$location,$window,$http){

  url = "<%= ENV['URL'] %>" || 'http://localhost:3000'

  var user;
  $auth.validateUser().then(function(resp) {
    user = resp;
  }).catch(function(resp) {
    
  })
  
  $scope.registrationForm = {};
  $scope.company = {};
  
  $scope.signup = function(){
    $http.post(url + '/companies',$scope.company).success(function(resp) {
      console.log(resp)
      $scope.registrationForm.company_id = resp.id
      console.log($scope.registrationForm)
      $auth.submitRegistration($scope.registrationForm).
        then(function(response){
          console.log(response)
          $window.location.href = '/#/dashboard';
        }).
        catch(function(response){
          console.log(response)
        });
      
    })
  }
}])