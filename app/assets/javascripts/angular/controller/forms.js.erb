app.controller('ListFormsCtrl', ['$scope', '$http','$auth','$location','user', function($scope, $http, $auth, $location, user){
  
  url = "<%= ENV['URL'] %>" || 'http://localhost:3000'

  $scope.noForms = false;

  $http.get(url + '/users/' + user.id + '/forms').success(function(resp) {
    $scope.forms = resp;
    if(!resp.length) {
      $scope.noForms = true;
    }
  });

  $scope.form = {};
  $scope.createForm = function() {
    $http.post(url + '/forms',$scope.form).success(function(response) {
      console.log(response)
      $location.path('forms/' + response.id + '/edit');
    }).error(function(response){
      alert("write something you douche");
    });
  }
}]);

app.controller('FormsUpdateCtrl', ['$scope', '$http', '$auth', '$location', '$routeParams', function($scope, $http, $auth, $location, $routeParams){

  url = "<%= ENV['URL'] %>" || 'http://localhost:3000'

  $scope.fields = []

  $scope.add = function(elem) {
    $scope.content = {
      label: '',
      options: [],
      category: elem.toString(),
      index: 0
    };

    $scope.fields.push(elem);
    $http.post(url + '/forms/' + $routeParams.id + '/contents',$scope.content).success(function(response) {
      console.log(response);
    }).error(function(response) {
      console.log(response);
    })
  };
  

  $scope.form = {};

  $http.get(url + '/forms/' + $routeParams.id).success(function(response) {
    console.log(response)
    $scope.form.name = response.name;
    $scope.form.contents = response.contents;
  })

}]);

